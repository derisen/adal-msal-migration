<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSAL.js</title>

    <script type="text/javascript" src="https://alcdn.msauth.net/browser/2.14.2/js/msal-browser.min.js"></script>
</head>

<div>
    <button id="loginButton">Login</button>
    <button id="logoutButton" style="visibility: hidden;">Logout</button>
    <button id="tokenButton" style="visibility: hidden;">Get Token</button>
</div>

<body>
    <script>

        const loginButton = document.getElementById("loginButton");
        const logoutButton = document.getElementById("logoutButton");
        const tokenButton = document.getElementById("tokenButton");

        const pca = new msal.PublicClientApplication({
            auth: {
                clientId: "0e745e2e-5ff0-42e4-9604-561d4f954b19",
                authority: "https://login.microsoftonline.com/cbaf2168-de14-4c72-9d88-f5f05366dbef",
                redirectUri: "http://localhost:3000",
            },
            cache: {
                cacheLocation: "sessionStorage"
            },
            system: {
                loggerOptions: {
                    loggerCallback(loglevel, message, containsPii) {
                        console.log(message);
                    },
                    piiLoggingEnabled: false,
                    logLevel: msal.LogLevel.Verbose,
                }
            }
        });

        loginButton.addEventListener('click', () => {
            pca.loginPopup().then((response) => {
                console.log(`Hello ${response.account.username}!`);

                loginButton.style.visibility = "hidden";
                logoutButton.style.visibility = "visible";
                tokenButton.style.visibility = "visible";
            })
        });

        logoutButton.addEventListener('click', () => {
            pca.logoutPopup().then((response) => {
                window.location.reload();
            })
        });

        tokenButton.addEventListener('click', () => {
            pca.acquireTokenPopup({
                scopes: ["User.Read"]
            }).then((response) => {
                console.log(response);
            })
        });
    </script>
</body>

</html>