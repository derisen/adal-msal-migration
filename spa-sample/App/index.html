<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADAL.js</title>

    <script src="https://secure.aadcdn.microsoftonline-p.com/lib/1.0.18/js/adal.min.js"></script>
</head>

<div>
    <button id="loginButton">Login</button>
    <button id="logoutButton" style="visibility: hidden;">Logout</button>
    <button id="tokenButton" style="visibility: hidden;">Get Token</button>
</div>

<body>
    <script type="text/javascript" src="./adal.js"></script>
    <script>

        const loginButton = document.getElementById("loginButton");
        const logoutButton = document.getElementById("logoutButton");
        const tokenButton = document.getElementById("tokenButton");

        var authContext = new AuthenticationContext({
            instance: 'https://login.microsoftonline.com/',
            clientId: "4c013f26-e4a7-498a-980a-d897f4312fc3",
            tenant: "cbaf2168-de14-4c72-9d88-f5f05366dbef",
            cacheLocation: "sessionStorage",
            redirectUri: "http://localhost:3000",
            popUp: true,
            callback: function (errorDesc, token, error, tokenType) {
                console.log('Hello ' + authContext.getCachedUser().profile.upn + '!')

                loginButton.style.visibility = "hidden";
                logoutButton.style.visibility = "visible";
                tokenButton.style.visibility = "visible";
            }
        });

        authContext.log({
            level: 3,
            log: function (message) {
                console.log(message);
            },
            piiLoggingEnabled: false
        });

        loginButton.addEventListener('click', function () {
            authContext.login();
        });

        logoutButton.addEventListener('click', function () {
            authContext.logOut();
        });

        tokenButton.addEventListener('click', () => {
            authContext.acquireTokenPopup("https://graph.microsoft.com", null, null, function (error, token) {
                console.log(error, token);
            })
        });
    </script>
</body>

</html>